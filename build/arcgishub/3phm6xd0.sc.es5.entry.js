arcgishub.loadBundle("3phm6xd0",["exports","./chunk-30344ebf.js"],function(t,i){var e=window.arcgishub.h,n=function(t){return"hubInitiativeId|"+t},o=function(t){return i.getUserUrl(t)+"/update"},r=function(t,i){return function(t){return t.tags.map(function(t){return t.replace(/^hubInitiativeId\|/,"")})}(t).indexOf(i)>-1},s=function(){function t(){var t=this;this.icon=e("svg",{draggable:"auto",class:"follow-icon",viewBox:"0 0 120 120",width:"100%",height:"100%"},e("circle",{cx:"18.385",cy:"101.615",r:"18.385"}),e("path",{d:"M-1.031 61c32.533 0 59 26.468 59 59s-26.467 59-59 59-59-26.468-59-59 26.467-59 59-59m0-23c-45.288 0-82 36.713-82 82s36.712 82 82 82 82-36.713 82-82-36.712-82-82-82z"}),e("path",{d:"M.154 23.041c53.349 0 96.75 43.402 96.75 96.75s-43.402 96.75-96.75 96.75-96.75-43.402-96.75-96.75 43.402-96.75 96.75-96.75m0-23c-66.136 0-119.75 53.615-119.75 119.75s53.614 119.75 119.75 119.75c66.135 0 119.75-53.615 119.75-119.75S66.289.041.154.041z"})),this.orgurl="https://www.arcgis.com",this.following=!1,this.callToActionText="Follow Our Initiative",this.triggerFollow=function(){return t.session=i.readSessionFromCookie(),t.session?t.toggleFollow():i.UserSession.beginOAuth2({clientId:t.clientid,portal:t.orgurl+"/sharing/rest",redirectUri:window.location+"authenticate.html"}).then(function(e){return i.writeSessionToCookie(e),t.session=e.serialize(),t.toggleFollow()})},this.toggleFollow=function(){return t.following?function(t){return i.request(i.getUserUrl(t.authentication),{authentication:t.authentication}).then(function(e){if(!r(e,t.initiativeId))return Promise.reject("user is not following this initiative.");var s=n(t.initiativeId),a=JSON.parse(JSON.stringify(e.tags)),u=a.indexOf(s);return a.splice(u,1),0===a.length&&a.push(","),i.request(o(t.authentication),{params:{tags:a},authentication:t.authentication})})}({initiativeId:t.initiativeid,authentication:i.UserSession.deserialize(t.session)}).then(function(t){if(t.success)return Promise.resolve()}).catch(function(t){if("user is not following this initiative."===t)return Promise.resolve()}).then(function(){return t.callToActionText="Follow Our Initiative",t.following=!1,{success:!0}}):(e={initiativeId:t.initiativeid,authentication:i.UserSession.deserialize(t.session)},i.request(i.getUserUrl(e.authentication),{authentication:e.authentication}).then(function(t){if(r(t,e.initiativeId))return Promise.reject("user is already following this initiative.");var s=n(e.initiativeId),a=JSON.parse(JSON.stringify(t.tags));return a.push(s),i.request(o(e.authentication),{params:{tags:a},authentication:e.authentication})})).then(function(t){if(t.success)return Promise.resolve(t)}).catch(function(t){if("user is already following this initiative."===t)return Promise.resolve()}).then(function(){return t.callToActionText="Unfollow Our Initiative",t.following=!0,{success:!0}});var e}}return t.prototype.render=function(){return e("hub-button",{text:this.callToActionText,action:this.triggerFollow,icon:this.icon})},Object.defineProperty(t,"is",{get:function(){return"hub-follow-initiative"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"properties",{get:function(){return{callToActionText:{state:!0},clientid:{type:String,attr:"clientid"},following:{type:Boolean,attr:"following",mutable:!0},icon:{type:"Any",attr:"icon"},initiativeid:{type:String,attr:"initiativeid"},orgurl:{type:String,attr:"orgurl"},session:{type:String,attr:"session",mutable:!0},user:{type:"Any",attr:"user",mutable:!0}}},enumerable:!0,configurable:!0}),Object.defineProperty(t,"style",{get:function(){return".follow-icon{height:15px;width:15px;vertical-align:baseline;padding-right:5px;fill:currentColor}"},enumerable:!0,configurable:!0}),t}();t.HubFollowInitiative=s,Object.defineProperty(t,"__esModule",{value:!0})});