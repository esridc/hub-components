arcgishub.loadBundle("chunk-30344ebf.js",["exports"],function(e){var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])})(e,t)};function t(e){return Object.keys(e).some(function(r){var t=e[r];if(!t)return!1;switch(t.constructor.name){case"Array":case"Object":case"Date":case"Function":case"Boolean":case"String":case"Number":return!1;default:return!0}})}function n(e){var r={};return Object.keys(e).forEach(function(t){var n=e[t];if(n||0===n||"boolean"==typeof n||"string"==typeof n){var o;switch(n.constructor.name){case"Array":o=n[0]&&n[0].constructor&&"Object"===n[0].constructor.name?JSON.stringify(n):n.join(",");break;case"Object":o=JSON.stringify(n);break;case"Date":o=n.valueOf();break;case"Function":o=null;break;case"Boolean":o=n+"";break;default:o=n}(o||0===o||"string"==typeof o)&&(r[t]=o)}}),r}function o(e){var r=n(e);return Object.keys(r).map(function(e){return function(e,r){return encodeURIComponent(e)+"="+encodeURIComponent(r)}(e,r[e])}).join("&")}e.__assign=function(){return e.__assign=Object.assign||function(e){for(var r,t=1,n=arguments.length;t<n;t++)for(var o in r=arguments[t])Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o]);return e},e.__assign.apply(this,arguments)};var s=function(e,r,t,n,o){e=e||"UNKNOWN_ERROR",r=r||"UNKNOWN_ERROR_CODE",this.name="ArcGISRequestError",this.message="UNKNOWN_ERROR_CODE"===r?e:r+": "+e,this.originalMessage=e,this.code=r,this.response=t,this.url=n,this.options=o};s.prototype=Object.create(Error.prototype),s.prototype.constructor=s;var i="@esri/arcgis-rest-js";function a(r,a){void 0===a&&(a={params:{f:"json"}});var u=e.__assign({httpMethod:"POST"},a),c=[],p=[];if(u.fetch||"undefined"==typeof fetch?(c.push("`fetch`"),p.push("`isomorphic-fetch`")):u.fetch=fetch.bind(Function("return this")()),"undefined"==typeof Promise&&(c.push("`Promise`"),p.push("`es6-promise`")),"undefined"==typeof FormData&&(c.push("`FormData`"),p.push("`isomorphic-form-data`")),!u.fetch||"undefined"==typeof Promise||"undefined"==typeof FormData)throw new Error("`arcgis-rest-request` requires global variables for `fetch`, `Promise` and `FormData` to be present in the global scope. You are missing "+c.join(", ")+". We recommend installing the "+p.join(", ")+" modules at the root of your application to add these to the global scope. See https://bit.ly/2KNwWaJ for more info.");var f=u.httpMethod,l=u.authentication,d=u.rawResponse,k=e.__assign({f:"json"},a.params),m={method:f,credentials:"same-origin"};return(l?l.getToken(r,{fetch:u.fetch}):Promise.resolve("")).then(function(s){if(s.length&&(k.token=s),"GET"===m.method){var h=""===o(k)?r:r+"?"+o(k);u.maxUrlLength&&h.length>u.maxUrlLength?m.method="POST":r=h}return"POST"===m.method&&(m.body=function(e){var r=t(e),s=n(e);if(r){var i=new FormData;return Object.keys(s).forEach(function(e){"undefined"!=typeof Blob&&s[e]instanceof Blob?i.append(e,s[e],s.fileName||s[e].name||e):i.append(e,s[e])}),i}return o(e)}(k)),m.headers=e.__assign({},a.headers),"undefined"!=typeof window||m.headers.referer||(m.headers.referer=i),t(k)||(m.headers["Content-Type"]="application/x-www-form-urlencoded"),u.fetch(r,m)}).then(function(e){if(!e.ok)throw new s(e.statusText,"HTTP "+e.status,e,r,u);if(d)return e;switch(k.f){case"json":case"geojson":return e.json();case"html":case"text":return e.text();default:return e.blob()}}).then(function(e){return"json"!==k.f&&"geojson"!==k.f||d?e:function(e,r,t,n){if(e.code>=400)throw new s(i=e.message,a=e.code,e,r,n);if(e.error){var o=e.error,i=o.message,a=o.code,u=o.messageCode,c=u||a||"UNKNOWN_ERROR_CODE";if(498===a||499===a||"GWM_0003"===u||400===a&&"Unable to generate token."===i)throw new h(i,c,e,r,n);throw new s(i,c,e,r,n)}if("failed"===e.status||"failure"===e.status){i=void 0,a="UNKNOWN_ERROR_CODE";try{i=JSON.parse(e.statusMessage).message,a=JSON.parse(e.statusMessage).code}catch(r){i=e.statusMessage||e.message}throw new s(i,a,e,r,n)}return e}(e,r,0,u)})}var u,h=function(t){function n(e,r,n,o,s){void 0===e&&(e="AUTHENTICATION_ERROR"),void 0===r&&(r="AUTHENTICATION_ERROR_CODE");var i=t.call(this,e,r,n,o,s)||this;return i.name="ArcGISAuthError",i.message="AUTHENTICATION_ERROR_CODE"===r?e:r+": "+e,i}return function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(n,t),n.prototype.retry=function(r,t){var n=this;void 0===t&&(t=3);var o=0,s=function(i,u){r(n.url,n.options).then(function(r){var t=e.__assign({},n.options,{authentication:r});return o+=1,a(n.url,t)}).then(function(e){i(e)}).catch(function(e){"ArcGISAuthError"===e.name&&o<t?s(i,u):u("ArcGISAuthError"===e.name&&o>=t?n:e)})};return new Promise(function(e,r){s(e,r)})},n}(s);function c(e){return"/"===(e=e.trim())[e.length-1]&&(e=e.slice(0,-1)),e}function p(e){return void 0===e&&(e={}),e.portal?c(e.portal):e.authentication?e.authentication.portal:"https://www.arcgis.com/sharing/rest"}function f(e,r){var t=r.params?r:{params:r};return t.rawResponse=!1,a(e,t).then(function(e){var r={token:e.access_token,username:e.username,expires:new Date(Date.now()+(1e3*e.expires_in-1e3)),ssl:!0===e.ssl};return e.refresh_token&&(r.refreshToken=e.refresh_token),r})}function l(e,r){var t=r.params?r:{params:r};return t.params.referer="undefined"!=typeof window&&window.location&&window.location.host?window.location.host:i,a(e,t)}!function(e){e.ArcGISRequestError="ArcGISRequestError",e.ArcGISAuthError="ArcGISAuthError"}(u||(u={}));var d=function(){function r(e){if(this.clientId=e.clientId,this._refreshToken=e.refreshToken,this._refreshTokenExpires=e.refreshTokenExpires,this.username=e.username,this.password=e.password,this._token=e.token,this._tokenExpires=e.tokenExpires,this.portal=e.portal?c(e.portal):"https://www.arcgis.com/sharing/rest",this.ssl=e.ssl,this.provider=e.provider||"arcgis",this.tokenDuration=e.tokenDuration||20160,this.redirectUri=e.redirectUri,this.refreshTokenTTL=e.refreshTokenTTL||1440,this.trustedServers={},e.server){var r=e.server.toLowerCase().split(/\/rest(\/admin)?\/services\//)[0];this.trustedServers[r]={token:e.token,expires:e.tokenExpires}}this._pendingTokenRequests={}}return r.beginOAuth2=function(t,n){void 0===n&&(n=window);var o,s=e.__assign({portal:"https://www.arcgis.com/sharing/rest",provider:"arcgis",duration:20160,popup:!0,state:t.clientId,locale:""},t),i=s.portal,a=s.provider,u=s.clientId,c=s.duration,p=s.redirectUri,f=s.popup,l=s.state,d=s.locale;if(o="arcgis"===a?i+"/oauth2/authorize?client_id="+u+"&response_type=token&expiration="+c+"&redirect_uri="+encodeURIComponent(p)+"&state="+l+"&locale="+d:i+"/oauth2/social/authorize?client_id="+u+"&socialLoginProviderName="+a+"&autoAccountCreateForSocial=true&response_type=token&expiration="+c+"&redirect_uri="+encodeURIComponent(p)+"&state="+l+"&locale="+d,f){var k,m=((k={promise:null,resolve:null,reject:null}).promise=new Promise(function(e,r){k.resolve=e,k.reject=r}),k);return n["__ESRI_REST_AUTH_HANDLER_"+u]=function(e,t){if(e){var n=JSON.parse(e);m.reject(new h(n.errorMessage,n.error))}else if(t){var o=JSON.parse(t);m.resolve(new r({clientId:u,portal:i,ssl:o.ssl,token:o.token,tokenExpires:new Date(o.expires),username:o.username}))}},n.open(o,"oauth-window","height=400,width=600,menubar=no,location=yes,resizable=yes,scrollbars=yes,status=yes"),m.promise}n.location.href=o},r.completeOAuth2=function(t,n){void 0===n&&(n=window);var o=e.__assign({portal:"https://www.arcgis.com/sharing/rest"},t),s=o.portal,i=o.clientId;function a(e,t){if(n.opener&&n.opener.parent)return n.opener.parent["__ESRI_REST_AUTH_HANDLER_"+i](e?JSON.stringify(e):void 0,JSON.stringify(t)),void n.close();if(n!==n.parent)return n.parent["__ESRI_REST_AUTH_HANDLER_"+i](e?JSON.stringify(e):void 0,JSON.stringify(t)),void n.close();if(e)throw new h(e.errorMessage,e.error);return new r({clientId:i,portal:s,ssl:t.ssl,token:t.token,tokenExpires:t.expires,username:t.username})}var u=n.location.href.match(/access_token=(.+)&expires_in=(.+)&username=([^&]+)/);if(!u){var c=n.location.href.match(/error=(.+)&error_description=(.+)/);return a({error:c[1],errorMessage:decodeURIComponent(c[2])})}var p=u[1],f=new Date(Date.now()+1e3*parseInt(u[2],10)-6e4),l=decodeURIComponent(u[3]);return a(void 0,{token:p,expires:f,ssl:n.location.href.indexOf("&ssl=true")>-1||n.location.href.indexOf("#ssl=true")>-1,username:l})},r.authorize=function(r,t){var n=e.__assign({portal:"https://arcgis.com/sharing/rest",duration:20160},r);t.writeHead(301,{Location:n.portal+"/oauth2/authorize?client_id="+n.clientId+"&duration="+n.duration+"&response_type=code&redirect_uri="+encodeURIComponent(n.redirectUri)}),t.end()},r.exchangeAuthorizationCode=function(t,n){var o=e.__assign({portal:"https://www.arcgis.com/sharing/rest",refreshTokenTTL:1440},t),s=o.portal,i=o.clientId,a=o.redirectUri,u=o.refreshTokenTTL;return f(s+"/oauth2/token",{grant_type:"authorization_code",client_id:i,redirect_uri:a,code:n}).then(function(e){return new r({clientId:i,portal:s,ssl:e.ssl,redirectUri:a,refreshToken:e.refreshToken,refreshTokenTTL:u,refreshTokenExpires:new Date(Date.now()+1e3*(u-1)),token:e.token,tokenExpires:e.expires,username:e.username})})},r.deserialize=function(e){var t=JSON.parse(e);return new r({clientId:t.clientId,refreshToken:t.refreshToken,refreshTokenExpires:new Date(t.refreshTokenExpires),username:t.username,password:t.password,token:t.token,tokenExpires:new Date(t.tokenExpires),portal:t.portal,ssl:t.ssl,tokenDuration:t.tokenDuration,redirectUri:t.redirectUri,refreshTokenTTL:t.refreshTokenTTL})},r.fromCredential=function(e){return new r({portal:e.server.includes("sharing/rest")?e.server:e.server+"/sharing/rest",ssl:e.ssl,token:e.token,username:e.userId,tokenExpires:new Date(e.expires)})},Object.defineProperty(r.prototype,"token",{get:function(){return this._token},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"tokenExpires",{get:function(){return this._tokenExpires},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"refreshToken",{get:function(){return this._refreshToken},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"refreshTokenExpires",{get:function(){return this._refreshTokenExpires},enumerable:!0,configurable:!0}),r.prototype.toCredential=function(){return{expires:this.tokenExpires.getTime(),server:this.portal,ssl:this.ssl,token:this.token,userId:this.username}},r.prototype.getUser=function(r){var t=this;return this._user&&this._user.username===this.username?Promise.resolve(this._user):a(this.portal+"/community/users/"+encodeURIComponent(this.username),e.__assign({httpMethod:"GET",authentication:this},r,{rawResponse:!1})).then(function(e){return t._user=e,e})},r.prototype.getToken=function(e,r){return/^https?:\/\/\S+\.arcgis\.com\/sharing\/rest/.test(this.portal)&&/^https?:\/\/\S+\.arcgis\.com.+/.test(e)?this.getFreshToken(r):new RegExp(this.portal,"i").test(e)?this.getFreshToken(r):this.getTokenForServer(e,r)},r.prototype.toJSON=function(){return{clientId:this.clientId,refreshToken:this.refreshToken,refreshTokenExpires:this.refreshTokenExpires,username:this.username,password:this.password,token:this.token,tokenExpires:this.tokenExpires,portal:this.portal,ssl:this.ssl,tokenDuration:this.tokenDuration,redirectUri:this.redirectUri,refreshTokenTTL:this.refreshTokenTTL}},r.prototype.serialize=function(){return JSON.stringify(this)},r.prototype.refreshSession=function(e){return this._user=null,this.username&&this.password?this.refreshWithUsernameAndPassword(e):this.clientId&&this.refreshToken?this.refreshWithRefreshToken():Promise.reject(new h("Unable to refresh token."))},r.prototype.getTokenForServer=function(e,r){var t=this,n=e.toLowerCase().split(/\/rest(\/admin)?\/services\//)[0],o=this.trustedServers[n];return o&&o.expires&&o.expires.getTime()>Date.now()?Promise.resolve(o.token):this._pendingTokenRequests[n]?this._pendingTokenRequests[n]:(this._pendingTokenRequests[n]=a(n+"/rest/info").then(function(o){if(o.owningSystemUrl){if(new RegExp(o.owningSystemUrl,"i").test(t.portal))return a(o.owningSystemUrl+"/sharing/rest/info",r);throw new h(e+" is not federated with "+t.portal+".","NOT_FEDERATED")}if(o.authInfo&&void 0!==t.trustedServers[n])return Promise.resolve({authInfo:o.authInfo});throw new h(e+" is not federated with any portal and is not explicitly trusted.","NOT_FEDERATED")}).then(function(e){return e.authInfo.tokenServicesUrl}).then(function(r){return t.token&&t.tokenExpires.getTime()>Date.now()?l(r,{params:{token:t.token,serverUrl:e,expiration:t.tokenDuration,client:"referer"}}):l(r,{params:{username:t.username,password:t.password,expiration:t.tokenDuration,client:"referer"}}).then(function(e){return t._token=e.token,t._tokenExpires=new Date(e.expires),e})}).then(function(e){return t.trustedServers[n]={expires:new Date(e.expires),token:e.token},e.token}),this._pendingTokenRequests[n])},r.prototype.getFreshToken=function(e){var r=this;return this.token&&this.tokenExpires&&this.tokenExpires.getTime()>Date.now()?Promise.resolve(this.token):(this._pendingTokenRequests[this.portal]||(this._pendingTokenRequests[this.portal]=this.refreshSession(e).then(function(e){return r._pendingTokenRequests[r.portal]=null,e.token})),this._pendingTokenRequests[this.portal])},r.prototype.refreshWithUsernameAndPassword=function(r){var t=this,n=e.__assign({params:{username:this.username,password:this.password,expiration:this.tokenDuration}},r);return l(this.portal+"/generateToken",n).then(function(e){return t._token=e.token,t._tokenExpires=new Date(e.expires),t})},r.prototype.refreshWithRefreshToken=function(r){var t=this;if(this.refreshToken&&this.refreshTokenExpires&&this.refreshTokenExpires.getTime()<Date.now())return this.refreshRefreshToken(r);var n=e.__assign({params:{client_id:this.clientId,refresh_token:this.refreshToken,grant_type:"refresh_token"}},r);return f(this.portal+"/oauth2/token",n).then(function(e){return t._token=e.token,t._tokenExpires=e.expires,t})},r.prototype.refreshRefreshToken=function(r){var t=this,n=e.__assign({params:{client_id:this.clientId,refresh_token:this.refreshToken,redirect_uri:this.redirectUri,grant_type:"exchange_refresh_token"}},r);return f(this.portal+"/oauth2/token",n).then(function(e){return t._token=e.token,t._tokenExpires=e.expires,t._refreshToken=e.refreshToken,t._refreshTokenExpires=new Date(Date.now()+60*(t.refreshTokenTTL-1)*1e3),t})},r}();e.getPortalUrl=p,e.request=a,e.appendCustomParams=function(e,r){Object.keys(e).forEach(function(t){"url"!==t&&"params"!==t&&"authentication"!==t&&"httpMethod"!==t&&"fetch"!==t&&"portal"!==t&&"maxUrlLength"!==t&&"headers"!==t&&"endpoint"!==t&&"decodeValues"!==t&&(r.params[t]=e[t])})},e.cleanUrl=c,e.readSessionFromCookie=function(){var e=document.cookie.match("(^|[^;]+)\\s*arcgis_hub_component_auth\\s*=\\s*([^;]+)");return e?e.pop():void 0},e.UserSession=d,e.writeSessionToCookie=function(e){var r=new Date;r.setTime(r.getTime()+12096e5),document.cookie="arcgis_hub_component_auth="+e.serialize()+" ; expires="+r.toUTCString()+" path=/"},e.getPortal=function(r,t){var n=r||"self";return a(p(t)+"/portals/"+n,e.__assign({httpMethod:"GET"},t))},e.getUserUrl=function(e){return p(e)+"/community/users/"+encodeURIComponent(e.username)}});